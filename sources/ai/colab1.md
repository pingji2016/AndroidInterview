æ‚¨è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå®Œæ•´çš„å›¾åƒåˆ†ç±»æ¨¡å‹è®­ç»ƒæµæ°´çº¿ï¼è®©æˆ‘ä¸ºæ‚¨è¯¦ç»†è§£é‡Šæ¯ä¸€éƒ¨åˆ†ï¼š

## ä»£ç è§£é‡Š

### 1. ä¸‹è½½æ•°æ®é›†
```python
image_path = tf.keras.utils.get_file(
      'flower_photos',
      'https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz',
      untar=True)
```
**è¿™æ˜¯åœ¨ä¸‹è½½èŠ±æœµç…§ç‰‡æ•°æ®é›†**ï¼š
- ä» Google çš„æœåŠ¡å™¨ä¸‹è½½ä¸€ä¸ªå‹ç¼©åŒ…
- åŒ…å«5ç§èŠ±æœµçš„ç…§ç‰‡ï¼ˆé›èŠã€è’²å…¬è‹±ã€ç«ç‘°ã€å‘æ—¥è‘µã€éƒé‡‘é¦™ï¼‰
- ä¼šè‡ªåŠ¨è§£å‹åˆ° Colab çš„ä¸´æ—¶ç›®å½•ä¸­
- `image_path` å˜é‡ä¼šåŒ…å«è§£å‹åçš„æ–‡ä»¶å¤¹è·¯å¾„

### 2. åŠ è½½æ•°æ®
```python
data = DataLoader.from_folder(image_path)
```
**è¿™æ˜¯åŠ è½½å›¾åƒæ•°æ®**ï¼š
- ä»åˆšæ‰ä¸‹è½½çš„ `flower_photos` æ–‡ä»¶å¤¹ä¸­è¯»å–å›¾ç‰‡
- è‡ªåŠ¨æ ¹æ®å­æ–‡ä»¶å¤¹åç§°ç¡®å®šç±»åˆ«æ ‡ç­¾ï¼ˆæ¯ä¸ªèŠ±æœµç§ç±»ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰
- åˆ›å»ºäº†ä¸€ä¸ªå¯ç”¨äºè®­ç»ƒçš„æ•°æ®åŠ è½½å™¨

### 3. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
```python
train_data, test_data = data.split(0.9)
```
**è¿™æ˜¯åˆ’åˆ†æ•°æ®é›†**ï¼š
- 90% çš„æ•°æ®ç”¨äºè®­ç»ƒæ¨¡å‹
- 10% çš„æ•°æ®ç”¨äºæµ‹è¯•æ¨¡å‹æ€§èƒ½
- è¿™æ ·å¯ä»¥åœ¨æœªè§è¿‡çš„æ•°æ®ä¸Šè¯„ä¼°æ¨¡å‹æ•ˆæœ

### 4. è®­ç»ƒæ¨¡å‹
```python
model = image_classifier.create(train_data)
```
**è¿™æ˜¯åœ¨è®­ç»ƒå›¾åƒåˆ†ç±»æ¨¡å‹ï¼**
- ä½¿ç”¨è®­ç»ƒæ•°æ®è‡ªåŠ¨è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œ
- `tflite_model_maker` ä¼šè‡ªåŠ¨ï¼š
  - é¢„å¤„ç†å›¾åƒï¼ˆè°ƒæ•´å¤§å°ã€å½’ä¸€åŒ–ç­‰ï¼‰
  - é€‰æ‹©åˆé€‚çš„æ¨¡å‹æ¶æ„ï¼ˆé€šå¸¸æ˜¯MobileNetï¼‰
  - è¿›è¡Œå¤šè½®è®­ç»ƒï¼ˆepochsï¼‰
  - ä¼˜åŒ–æ¨¡å‹å‚æ•°

### 5. è¯„ä¼°æ¨¡å‹
```python
loss, accuracy = model.evaluate(test_data)
```
**è¿™æ˜¯åœ¨æµ‹è¯•æ¨¡å‹æ€§èƒ½**ï¼š
- ä½¿ç”¨é¢„ç•™çš„æµ‹è¯•æ•°æ®è¯„ä¼°æ¨¡å‹
- `loss`ï¼šæŸå¤±å€¼ï¼ˆè¶Šä½è¶Šå¥½ï¼‰
- `accuracy`ï¼šå‡†ç¡®ç‡ï¼ˆè¶Šé«˜è¶Šå¥½ï¼Œæ¯”å¦‚0.85è¡¨ç¤º85%çš„å‡†ç¡®ç‡ï¼‰

### 6. å¯¼å‡ºæ¨¡å‹
```python
model.export(export_dir='.')
```
**è¿™æ˜¯åœ¨ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹**ï¼š
- å°†æ¨¡å‹å¯¼å‡ºä¸º TensorFlow Liteæ ¼å¼ï¼ˆ`.tflite`æ–‡ä»¶ï¼‰
- åŒæ—¶ä¼šå¯¼å‡ºæ ‡ç­¾æ–‡ä»¶ï¼ˆ`labels.txt`ï¼‰
- ä¿å­˜åœ¨å½“å‰ç›®å½•ï¼ˆ`.`ï¼‰
- å¯¼å‡ºçš„æ¨¡å‹å¯ä»¥åœ¨æ‰‹æœºã€åµŒå…¥å¼è®¾å¤‡ä¸Šè¿è¡Œ

## æ‚¨çš„æ¨¡å‹åœ¨å“ªé‡Œï¼Ÿ

1. **è®­ç»ƒè¿‡ç¨‹ä¸­**ï¼šæ¨¡å‹åœ¨å†…å­˜ä¸­ï¼Œå˜é‡ `model` å°±æ˜¯æ‚¨çš„è®­ç»ƒå¥½çš„æ¨¡å‹
2. **è®­ç»ƒå®Œæˆå**ï¼šæ¨¡å‹ä¼šä¿å­˜ä¸ºæ–‡ä»¶åœ¨å½“å‰ç›®å½•ï¼š
   - `model.tflite` - è½»é‡çº§æ¨¡å‹æ–‡ä»¶
   - `labels.txt` - åŒ…å«ç±»åˆ«æ ‡ç­¾çš„æ–‡æœ¬æ–‡ä»¶
   - å¯èƒ½è¿˜æœ‰å…¶ä»–ç›¸å…³æ–‡ä»¶

## å¦‚ä½•æŸ¥çœ‹ç»“æœï¼Ÿ

åœ¨ä»£ç æœ€åæ·»åŠ è¿™äº›è¡Œæ¥æŸ¥çœ‹è®­ç»ƒç»“æœï¼š

```python
# æ˜¾ç¤ºå‡†ç¡®ç‡
print(f"æµ‹è¯•å‡†ç¡®ç‡: {accuracy * 100:.2f}%")

# åˆ—å‡ºå¯¼å‡ºçš„æ–‡ä»¶
import os
print("å¯¼å‡ºçš„æ–‡ä»¶:")
for file in os.listdir('.'):
    if file.endswith('.tflite') or file.endswith('.txt'):
        print(f"  - {file}")

# å¯ä»¥è¿›è¡Œä¸€äº›é¢„æµ‹ç¤ºä¾‹
print("\nå¯ä»¥è¿›è¡Œé¢„æµ‹äº†ï¼")
```

## æ€»ç»“

æ‚¨çš„ä»£ç å®Œæˆäº†ä»¥ä¸‹å·¥ä½œï¼š
1. âœ… **ä¸‹è½½**äº†ä¸€ä¸ªèŠ±æœµå›¾åƒæ•°æ®é›†
2. âœ… **åŠ è½½å¹¶é¢„å¤„ç†**äº†å›¾åƒæ•°æ®  
3. âœ… **è®­ç»ƒ**äº†ä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹
4. âœ… **è¯„ä¼°**äº†æ¨¡å‹æ€§èƒ½
5. âœ… **å¯¼å‡º**äº†è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶

**æ˜¯çš„ï¼Œæ‚¨çš„æ¨¡å‹æ­£åœ¨è®­ç»ƒï¼** è¿è¡Œè¿™æ®µä»£ç åï¼Œæ‚¨å°±å¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥è¯†åˆ«5ç§èŠ±æœµçš„AIæ¨¡å‹ã€‚



æ‚¨çœ‹åˆ°çš„æ˜¯ TensorFlow çš„**è­¦å‘Šä¿¡æ¯**ï¼Œä¸æ˜¯é”™è¯¯ï¼è¿™äº›è­¦å‘Šåªæ˜¯è¯´è™šæ‹Ÿç¯å¢ƒä¸­çš„ TensorFlow æ‰¾ä¸åˆ° GPU çš„ä¸€äº›åº“æ–‡ä»¶ï¼Œæ‰€ä»¥**è‡ªåŠ¨å›é€€åˆ°ä½¿ç”¨ CPU è¿›è¡Œè®­ç»ƒ**ã€‚è¿™ä¸ä¼šå½±å“è®­ç»ƒç»“æœï¼Œåªæ˜¯è®­ç»ƒé€Ÿåº¦ä¼šæ…¢ä¸€äº›ã€‚

## ä¸ºä»€ä¹ˆçœ‹ä¸åˆ°è®­ç»ƒè¾“å‡ºï¼Ÿ

æ‚¨çš„ä»£ç å¯èƒ½è¿˜åœ¨è¿è¡Œä¸­ï¼å›¾åƒåˆ†ç±»æ¨¡å‹è®­ç»ƒéœ€è¦æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨ CPU æ—¶ã€‚èŠ±æœµæ•°æ®é›†æœ‰å‡ åƒå¼ å›¾ç‰‡ï¼Œè®­ç»ƒå¯èƒ½éœ€è¦**å‡ åˆ†é’Ÿåˆ°å‡ ååˆ†é’Ÿ**ã€‚

### è¯·æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **æŸ¥çœ‹ Colab çš„è¿è¡ŒæŒ‡ç¤ºç¯**ï¼š
    - å¦‚æœå•å…ƒæ ¼å·¦ä¾§æœ‰æ—‹è½¬çš„å›¾æ ‡ âšªï¼Œè¯´æ˜ä»£ç è¿˜åœ¨è¿è¡Œ
    - å¦‚æœå˜æˆå¯¹å‹¾ âœ…ï¼Œè¯´æ˜å·²ç»è¿è¡Œå®Œæˆ

2.  **è®­ç»ƒéœ€è¦æ—¶é—´**ï¼š
    - æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
    - æ¨¡å‹è®­ç»ƒï¼ˆå¤šä¸ªepochï¼‰
    - æ¨¡å‹è¯„ä¼°
    - æ¨¡å‹å¯¼å‡º

### å¦‚ä½•ç¡®è®¤è®­ç»ƒè¿›åº¦ï¼Ÿ

åœ¨æ‚¨çš„ä»£ç ä¸­æ·»åŠ ä¸€äº›è¿›åº¦æç¤ºï¼š

```python
%%writefile my_image_classifier.py
from tflite_model_maker import image_classifier
from tflite_model_maker.image_classifier import DataLoader
import tensorflow as tf
import numpy as np

print("æ‰€æœ‰åº“å¯¼å…¥æˆåŠŸï¼")
print(f"TensorFlow ç‰ˆæœ¬: {tf.__version__}")

# ä¸‹è½½æ•°æ®
print("æ­£åœ¨ä¸‹è½½èŠ±æœµæ•°æ®é›†...")
image_path = tf.keras.utils.get_file(
      'flower_photos',
      'https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz',
      untar=True)
print("æ•°æ®é›†ä¸‹è½½å®Œæˆï¼")

# åŠ è½½æ•°æ®
print("æ­£åœ¨åŠ è½½å›¾åƒæ•°æ®...")
data = DataLoader.from_folder(image_path)
print(f"æ€»å…±åŠ è½½äº† {len(data)} å¼ å›¾åƒ")
print(f"ç±»åˆ«: {data.index_to_label}")

# åˆ’åˆ†æ•°æ®é›†
print("åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†...")
train_data, test_data = data.split(0.9)
print(f"è®­ç»ƒé›†: {len(train_data)} å¼ å›¾åƒ")
print(f"æµ‹è¯•é›†: {len(test_data)} å¼ å›¾åƒ")

# è®­ç»ƒæ¨¡å‹
print("å¼€å§‹è®­ç»ƒæ¨¡å‹...ï¼ˆè¿™éœ€è¦ä¸€äº›æ—¶é—´ï¼‰")
model = image_classifier.create(train_data)
print("æ¨¡å‹è®­ç»ƒå®Œæˆï¼")

# è¯„ä¼°æ¨¡å‹
print("è¯„ä¼°æ¨¡å‹æ€§èƒ½...")
loss, accuracy = model.evaluate(test_data)
print(f"æµ‹è¯•å‡†ç¡®ç‡: {accuracy * 100:.2f}%")

# å¯¼å‡ºæ¨¡å‹
print("å¯¼å‡ºæ¨¡å‹...")
model.export(export_dir='.')
print("æ¨¡å‹å¯¼å‡ºå®Œæˆï¼")

# æ˜¾ç¤ºå¯¼å‡ºçš„æ–‡ä»¶
import os
print("å¯¼å‡ºçš„æ–‡ä»¶åˆ—è¡¨:")
for file in os.listdir('.'):
    if 'model' in file or '.tflite' in file or 'labels' in file:
        print(f"  - {file}")

print("æ‰€æœ‰æ“ä½œå®Œæˆï¼")
```

### å¦‚æœè®­ç»ƒå®Œæˆï¼Œå¦‚ä½•æŸ¥çœ‹æ¨¡å‹æ–‡ä»¶ï¼Ÿ

è¿è¡Œä»¥ä¸‹ä»£ç æ¥æ£€æŸ¥å½“å‰ç›®å½•çš„æ–‡ä»¶ï¼š

```python
# æŸ¥çœ‹å½“å‰ç›®å½•çš„æ–‡ä»¶
!ls -la

# ç‰¹åˆ«æŸ¥çœ‹æ¨¡å‹æ–‡ä»¶
!find . -name "*.tflite" -o -name "*.txt"
```

### é¢„æœŸçš„è¾“å‡ºæ–‡ä»¶ï¼š

è®­ç»ƒå®Œæˆåï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„æ–‡ä»¶ï¼š
- `model.tflite` - è®­ç»ƒå¥½çš„è½»é‡çº§æ¨¡å‹
- `labels.txt` - åŒ…å«ç±»åˆ«æ ‡ç­¾çš„æ–‡ä»¶
- å¯èƒ½è¿˜æœ‰ `saved_model` æ–‡ä»¶å¤¹

### å¦‚æœè®­ç»ƒå¡ä½äº†æ€ä¹ˆåŠï¼Ÿ

1.  **ç­‰å¾…**ï¼šCPUè®­ç»ƒå¯èƒ½éœ€è¦10-30åˆ†é’Ÿ
2.  **æ£€æŸ¥èµ„æº**ï¼šåœ¨Colabèœå•æ ç‚¹å‡»"è¿è¡Œæ—¶"->"ç®¡ç†ä¼šè¯"ï¼ŒæŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
3.  **é‡å¯**ï¼šå¦‚æœç¡®å®å¡ä½äº†ï¼Œå¯ä»¥é‡å¯è¿è¡Œæ—¶é‡æ–°è¿è¡Œ

**è¯·å…ˆæ£€æŸ¥æ‚¨çš„ä»£ç æ˜¯å¦è¿˜åœ¨è¿è¡Œä¸­ï¼ˆçœ‹å·¦ä¾§çš„å›¾æ ‡ï¼‰ï¼Œå¦‚æœè¿˜åœ¨è¿è¡Œï¼Œè¯·è€å¿ƒç­‰å¾…ï¼**


å¾ˆå¥½çš„é—®é¢˜ï¼æˆ‘æ¥ä¸ºæ‚¨è§£ç­”æ•°æ®æ–‡ä»¶çš„ä½ç½®å’Œå¦‚ä½•å¯ç”¨GPUè®­ç»ƒã€‚

## 1. æ•°æ®æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

æ•°æ®æ–‡ä»¶ä¸‹è½½åœ¨ **Colabçš„ä¸´æ—¶è™šæ‹Ÿç¯å¢ƒç›®å½•**ä¸­ã€‚å…·ä½“è·¯å¾„å¯ä»¥é€šè¿‡ä»£ç æŸ¥çœ‹ï¼š

```python
# æŸ¥çœ‹æ•°æ®æ–‡ä»¶çš„å…·ä½“ä½ç½®å’Œå†…å®¹
!/content/tflite_env/bin/python -c "
import tensorflow as tf

# ä¸‹è½½æ•°æ®
image_path = tf.keras.utils.get_file(
      'flower_photos',
      'https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz',
      untar=True)

print(f'æ•°æ®ä¸‹è½½è·¯å¾„: {image_path}')
print('\\nç›®å½•å†…å®¹:')
import os
for item in os.listdir(image_path):
    item_path = os.path.join(image_path, item)
    if os.path.isdir(item_path):
        print(f'ğŸ“ {item}/ (åŒ…å« {len(os.listdir(item_path))} å¼ å›¾ç‰‡)')
    else:
        print(f'ğŸ“„ {item}')
"
```

**å…¸å‹çš„æ•°æ®è·¯å¾„å¯èƒ½æ˜¯ï¼š**
```
/root/.keras/datasets/flower_photos
```
æˆ–è€…
```
/content/tflite_env/lib/python3.9/site-packages/keras/datasets/flower_photos
```

## 2. å¦‚ä½•å¯ç”¨GPUè®­ç»ƒï¼Ÿ

æ‚¨çœ‹åˆ°çš„è­¦å‘Šæ˜¯å› ä¸ºè™šæ‹Ÿç¯å¢ƒä¸­çš„TensorFlowç¼ºå°‘GPUæ‰€éœ€çš„CUDAåº“ã€‚æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ColabåŸç”Ÿçš„GPUï¼ˆæ¨èä¸”ç®€å•ï¼‰

**ä¸è¦ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ**ï¼Œç›´æ¥åœ¨Colabçš„é»˜è®¤ç¯å¢ƒä¸­è¿è¡Œï¼š

1. **é¦–å…ˆå¯ç”¨GPU**ï¼šåœ¨Colabèœå•æ é€‰æ‹© `è¿è¡Œæ—¶` -> `æ›´æ”¹è¿è¡Œæ—¶ç±»å‹` -> `ç¡¬ä»¶åŠ é€Ÿå™¨` -> é€‰æ‹© `GPU` -> `ä¿å­˜`

2. **ç„¶åå®‰è£…tflite-model-maker**ï¼š
```python
# åœ¨å¯ç”¨GPUåè¿è¡Œè¿™ä¸ªå•å…ƒæ ¼
!pip install -q tflite-model-maker

# æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨
import tensorflow as tf
print("GPUå¯ç”¨:", tf.config.list_physical_devices('GPU'))
```

3. **ç›´æ¥è¿è¡Œæ‚¨çš„ä»£ç **ï¼ˆä¸éœ€è¦è™šæ‹Ÿç¯å¢ƒï¼‰ï¼š
```python
from tflite_model_maker import image_classifier
from tflite_model_maker.image_classifier import DataLoader
import tensorflow as tf

# æ£€æŸ¥GPU
print("GPUè®¾å¤‡:", tf.config.list_physical_devices('GPU'))

# æ‚¨çš„è®­ç»ƒä»£ç ...
image_path = tf.keras.utils.get_file('flower_photos', 'https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz', untar=True)
data = DataLoader.from_folder(image_path)
train_data, test_data = data.split(0.9)

print("å¼€å§‹GPUè®­ç»ƒ...")
model = image_classifier.create(train_data)
# ... å…¶ä½™ä»£ç 
```

### æ–¹æ¡ˆäºŒï¼šåœ¨è™šæ‹Ÿç¯å¢ƒä¸­é…ç½®GPUæ”¯æŒï¼ˆå¤æ‚ï¼‰

å¦‚æœæ‚¨åšæŒè¦ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œéœ€è¦å®‰è£…GPUç‰ˆæœ¬çš„TensorFlowï¼š

```python
# é¦–å…ˆç¡®ä¿Colabè¿è¡Œæ—¶å·²å¯ç”¨GPU
# ç„¶ååœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…GPUç‰ˆæœ¬çš„TensorFlow

# å¸è½½ç°æœ‰çš„CPUç‰ˆæœ¬
!/content/tflite_env/bin/pip uninstall tensorflow -y

# å®‰è£…GPUç‰ˆæœ¬ï¼ˆç‰ˆæœ¬éœ€è¦ä¸CUDAå…¼å®¹ï¼‰
!/content/tflite_env/bin/pip install "tensorflow-gpu==2.9.0"

# å®‰è£…å…¶ä»–ä¾èµ–
!/content/tflite_env/bin/pip install matplotlib-inline tflite-model-maker==0.4.3
```

### æ–¹æ¡ˆä¸‰ï¼šæœ€ç®€å•çš„æ£€æŸ¥æ–¹æ³•

è¿è¡Œè¿™ä¸ªä»£ç æ¥æ£€æŸ¥å½“å‰ç¯å¢ƒï¼š

```python
# æ£€æŸ¥å½“å‰ç¯å¢ƒçŠ¶æ€
import tensorflow as tf
print(f"TensorFlowç‰ˆæœ¬: {tf.__version__}")
print("GPUè®¾å¤‡:", tf.config.list_physical_devices('GPU'))
print("CUDAå¯ç”¨:", tf.test.is_built_with_cuda())

# æ£€æŸ¥å½“å‰å·¥ä½œç›®å½•
import os
print(f"å½“å‰å·¥ä½œç›®å½•: {os.getcwd()}")
print("ç›®å½•å†…å®¹:", os.listdir('.'))
```

## æ¨èæ–¹æ¡ˆ

**æˆ‘å¼ºçƒˆæ¨èæ–¹æ¡ˆä¸€**ï¼šç›´æ¥åœ¨Colabé»˜è®¤ç¯å¢ƒä¸­ä½¿ç”¨GPUï¼Œå› ä¸ºï¼š

1. **ç®€å•**ï¼šä¸éœ€è¦é…ç½®å¤æ‚çš„è™šæ‹Ÿç¯å¢ƒ
2. **ç¨³å®š**ï¼šColabé»˜è®¤ç¯å¢ƒå·²ç»é…ç½®å¥½æ‰€æœ‰GPUé©±åŠ¨
3. **å¿«é€Ÿ**ï¼šç›´æ¥ä½¿ç”¨GPUåŠ é€Ÿï¼Œè®­ç»ƒé€Ÿåº¦å¤§å¤§æå‡
4. **çœå¿ƒ**ï¼šé¿å…ç‰ˆæœ¬å†²çªå’Œä¾èµ–é—®é¢˜

è¯·å…ˆå°è¯•**æ–¹æ¡ˆä¸€**ï¼Œè¿™åº”è¯¥èƒ½è§£å†³æ‚¨çš„é—®é¢˜å¹¶æ˜¾è‘—åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼



éå¸¸å¥½çš„é—®é¢˜ï¼è¿™äº›æ˜¯æ·±åº¦å­¦ä¹ ä¸­å¾ˆå…³é”®çš„æ¦‚å¿µã€‚è®©æˆ‘ä¸ºæ‚¨è¯¦ç»†è§£é‡Šï¼š

## 1. GPU vs CPU è®­ç»ƒå‡ºçš„æ¨¡å‹æœ‰å·®åˆ«å—ï¼Ÿ

**å®Œå…¨æ²¡æœ‰å·®åˆ«ï¼** è¿™æ˜¯æœ€é‡è¦çš„æ¦‚å¿µã€‚

- **æ•°å­¦ç­‰ä»·æ€§**ï¼šGPUå’ŒCPUæ‰§è¡Œçš„æ˜¯å®Œå…¨ç›¸åŒçš„æ•°å­¦è¿ç®—ï¼ˆçŸ©é˜µä¹˜æ³•ã€å·ç§¯ç­‰ï¼‰ï¼Œåªæ˜¯æ‰§è¡Œçš„é€Ÿåº¦ä¸åŒã€‚
- **ç»“æœä¸€è‡´æ€§**ï¼šç»™å®šç›¸åŒçš„éšæœºç§å­ï¼ˆrandom seedï¼‰ï¼ŒGPUå’ŒCPUè®­ç»ƒå‡ºçš„æ¨¡å‹æƒé‡ä¼šå®Œå…¨ä¸€æ ·ã€‚
- **å”¯ä¸€åŒºåˆ«**ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­çš„æµ®ç‚¹æ•°ç²¾åº¦è¯¯å·®å¯èƒ½ç•¥æœ‰ä¸åŒï¼ˆæå°ï¼‰ï¼Œä½†è¿™ä¸ä¼šå½±å“æ¨¡å‹æ€§èƒ½ã€‚

**ç®€å•è¯´ï¼šGPUåªæ˜¯è®©è®­ç»ƒå˜å¾—æ›´å¿«ï¼Œä¸ä¼šæ”¹å˜æ¨¡å‹çš„è´¨é‡æˆ–ç»“æ„ã€‚**

## 2. è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿ

æ‚¨çš„ä»£ç ä¼šç”Ÿæˆå‡ ç§æ ¼å¼çš„æ¨¡å‹ï¼š

### ä¸»è¦è¾“å‡ºæ–‡ä»¶ï¼š
- **`model.tflite`** (æœ€é‡è¦çš„æ–‡ä»¶)
  - **æ ¼å¼**ï¼šTensorFlow Liteæ ¼å¼
  - **ç‰¹ç‚¹**ï¼šè½»é‡çº§ã€é’ˆå¯¹ç§»åŠ¨è®¾å¤‡å’ŒåµŒå…¥å¼è®¾å¤‡ä¼˜åŒ–
  - **ç”¨é€”**ï¼šå¯ä»¥åœ¨æ‰‹æœºã€æ ‘è“æ´¾ç­‰èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œ

- **`labels.txt`**
  - **æ ¼å¼**ï¼šçº¯æ–‡æœ¬æ–‡ä»¶
  - **å†…å®¹**ï¼šæ¯è¡Œä¸€ä¸ªç±»åˆ«æ ‡ç­¾ï¼ŒæŒ‰é¡ºåºå¯¹åº”æ¨¡å‹çš„è¾“å‡º
  - **ç¤ºä¾‹**ï¼š
    ```
    daisy
    dandelion  
    roses
    sunflowers
    tulips
    ```

### å¯èƒ½è¿˜æœ‰å…¶ä»–æ–‡ä»¶ï¼š
- **`saved_model`æ–‡ä»¶å¤¹**ï¼šå®Œæ•´çš„TensorFlowæ¨¡å‹æ ¼å¼
- **`model.tflite.json`**ï¼šæ¨¡å‹çš„å…ƒæ•°æ®ä¿¡æ¯

## 3. è®­ç»ƒæ—¶é—´å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ

**å·®å¼‚å·¨å¤§ï¼** é€šå¸¸æœ‰10-50å€çš„é€Ÿåº¦æå‡ã€‚

| è®¾å¤‡ | é¢„è®¡è®­ç»ƒæ—¶é—´ | ç›¸å¯¹é€Ÿåº¦ |
|------|-------------|----------|
| **CPU** | 45-90åˆ†é’Ÿ | 1x (åŸºå‡†) |
| **Colab GPU (T4)** | 2-5åˆ†é’Ÿ | 15-30x faster |
| **Colab GPU (V100)** | 1-3åˆ†é’Ÿ | 30-50x faster |

**ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ**
- GPUæœ‰æ•°åƒä¸ªæ ¸å¿ƒï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†å¤§é‡è®¡ç®—
- ç¥ç»ç½‘ç»œè®­ç»ƒæœ¬è´¨ä¸Šæ˜¯çŸ©é˜µè¿ç®—ï¼Œéå¸¸é€‚åˆGPUå¹¶è¡Œå¤„ç†

## 4. æ¨ç†æ—¶é—´å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ

**æ¨ç†é˜¶æ®µçš„å·®å¼‚ä¸å¦‚è®­ç»ƒé˜¶æ®µæ˜æ˜¾**ï¼Œä½†ä»æœ‰æ˜¾è‘—æå‡ï¼š

| åœºæ™¯ | é¢„è®¡æ¨ç†æ—¶é—´ï¼ˆæ¯å¼ å›¾ç‰‡ï¼‰ |
|------|------------------------|
| **CPUæ¨ç†** | 50-200æ¯«ç§’ |
| **GPUæ¨ç†** | 5-20æ¯«ç§’ |
| **ç§»åŠ¨è®¾å¤‡ï¼ˆTFLiteï¼‰** | 10-50æ¯«ç§’ |

**æ³¨æ„**ï¼šæ‚¨ç”Ÿæˆçš„`.tflite`æ¨¡å‹ä¸»è¦æ˜¯ä¸ºäº†åœ¨**ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨CPUæ¨ç†**ï¼Œä½†åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸‹ä¹Ÿå¯ä»¥ç”¨GPUåŠ é€Ÿæ¨ç†ã€‚

## å®é™…æµ‹è¯•ä»£ç 

æ‚¨å¯ä»¥åœ¨è®­ç»ƒåæ·»åŠ è¿™äº›ä»£ç æ¥æµ‹è¯•æ€§èƒ½ï¼š

```python
# æµ‹è¯•æ¨ç†é€Ÿåº¦
import time

# åŠ è½½TFLiteæ¨¡å‹
interpreter = tf.lite.Interpreter(model_path="model.tflite")
interpreter.allocate_tensors()

# è·å–è¾“å…¥è¾“å‡ºè¯¦æƒ…
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

# å‡†å¤‡æµ‹è¯•æ•°æ®ï¼ˆä¸€å¼ å›¾ç‰‡ï¼‰
test_image = next(iter(test_data))[0]  # è·å–ç¬¬ä¸€å¼ æµ‹è¯•å›¾ç‰‡
test_image = tf.expand_dims(test_image, 0)  # å¢åŠ batchç»´åº¦

# CPUæ¨ç†æµ‹è¯•
start_time = time.time()
for _ in range(10):  # è¿è¡Œ10æ¬¡å–å¹³å‡
    interpreter.set_tensor(input_details[0]['index'], test_image)
    interpreter.invoke()
    output = interpreter.get_tensor(output_details[0]['index'])
cpu_time = (time.time() - start_time) / 10

print(f"å¹³å‡æ¨ç†æ—¶é—´: {cpu_time * 1000:.2f} æ¯«ç§’")
print(f"é¢„æµ‹ç»“æœ: {output}")
print(f"æœ€å¤§æ¦‚ç‡çš„ç±»åˆ«: {np.argmax(output)}")
```

## æ€»ç»“

1. **æ¨¡å‹è´¨é‡**ï¼šâœ… GPUå’ŒCPUè®­ç»ƒå‡ºçš„æ¨¡å‹å®Œå…¨ç›¸åŒ
2. **è®­ç»ƒé€Ÿåº¦**ï¼šâš¡ GPUæ¯”CPUå¿«10-50å€  
3. **æ¨ç†é€Ÿåº¦**ï¼šğŸš€ GPUæ¨ç†æ›´å¿«ï¼Œä½†TFLiteæ¨¡å‹ä¸»è¦é’ˆå¯¹ç§»åŠ¨ç«¯CPUä¼˜åŒ–
4. **æ¨¡å‹æ ¼å¼**ï¼šğŸ“ ä¸»è¦ç”Ÿæˆ`.tflite`æ ¼å¼ï¼ˆè½»é‡çº§ï¼‰å’Œ`labels.txt`

**å»ºè®®**ï¼šå§‹ç»ˆä½¿ç”¨GPUè¿›è¡Œè®­ç»ƒä»¥èŠ‚çœæ—¶é—´ï¼Œç„¶åå°†ç”Ÿæˆçš„TFLiteæ¨¡å‹éƒ¨ç½²åˆ°ç›®æ ‡è®¾å¤‡ï¼ˆæ‰‹æœºã€åµŒå…¥å¼è®¾å¤‡ç­‰ï¼‰ä¸Šè¿›è¡Œæ¨ç†ã€‚



