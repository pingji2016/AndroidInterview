好的，当然可以。我将你关于 **Linux 服务器管理、Web 服务部署、HTTPS 配置**等一系列问题进行了系统的梳理和汇总，形成了一份完整的指南。

---

# 🚀 Linux 服务器运维与Web部署终极指南

## 目录
1.  [系统状态与网络服务查看](#1-系统状态与网络服务查看)
2.  [宝塔面板故障排查](#2-宝塔面板故障排查)
3.  [Web服务（Nginx）深度解析](#3-web服务nginx深度解析)
4.  [进程后台运行与管理](#4-进程后台运行与管理)
5.  [文件操作与传输](#5-文件操作与传输)
6.  [HTTPS 配置全攻略](#6-https-配置全攻略)
7.  [核心概念解析](#7-核心概念解析)

---

## 1. 系统状态与网络服务查看

### 查看后台服务
```bash
# 查看所有已启动的systemd服务
systemctl list-units --type=service --state=running

# 查看所有开机自启的服务
systemctl list-unit-files --state=enabled
```

### 查看对外提供网络服务的进程
```bash
# 查看所有监听端口的进程 (推荐使用)
sudo ss -tulnp
# 传统命令
sudo netstat -tulnp
# 查看正在监听的程序
sudo lsof -i -P -n | grep LISTEN
```
**关键指标**：`Local Address:Port` (如 `0.0.0.0:80`)、`Process`。

---

## 2. 宝塔面板故障排查

### 找回访问信息
```bash
# 获取面板地址、安全入口、用户名和密码
sudo /etc/init.d/bt default
# 或直接查找安全入口
sudo cat /www/server/panel/data/admin_path.pl
```
访问地址格式：`https://你的服务器IP:端口/安全入口`

### 服务管理
```bash
# 启动/重启/查看状态
sudo systemctl start bt
sudo systemctl restart bt
sudo systemctl status bt
```

---

## 3. Web服务（Nginx）深度解析

### Nginx 配置体系
*   **主配置**：`/etc/nginx/nginx.conf` (或 `/www/server/nginx/conf/nginx.conf`)
    *   定义全局参数。
    *   通过 `include` 指令加载子配置。
*   **子配置**：`/www/server/panel/vhost/nginx/*.conf`
    *   每个网站（包括宝塔面板、PHPMyAdmin、你的项目）一个文件。
    *   **修改网站配置应在此处进行**，而不是主配置。

### 诊断命令
```bash
# 检查Nginx状态
systemctl status nginx
# 测试配置文件语法
nginx -t
# 重新加载配置（无需重启）
nginx -s reload
# 或
systemctl reload nginx
# 查看端口监听情况
ss -tulnp | grep :80
```

### 解决 404/502 错误
*   **404**：路径错误，通常意味着Nginx收到了请求但找不到对应资源。检查 `root` 和 `index` 指令。
*   **502 Bad Gateway**：Nginx无法连接到后端服务（如PHP-FPM、Node.js）。检查后端服务是否运行、端口是否正确。

---

## 4. 进程后台运行与管理

### 使用 PM2 (Node.js 应用首选)
```bash
# 安装
npm install pm2 -g

# 启动并管理应用
pm2 start app.js --name "my-app"   # 启动普通Node应用
pm2 start npm --name "my-hexo" -- run start # 启动Hexo等npm项目

# 常用命令
pm2 list                           # 查看列表
pm2 logs my-app                    # 查看日志
pm2 restart my-app                 # 重启
pm2 delete my-app                  # 删除
pm2 startup                       # 设置开机自启
pm2 save                          # 保存当前列表

# 用配置文件启动 (ecosystem.config.js)
pm2 start ecosystem.config.js
```

### 其他方法
```bash
# 1. 使用nohup (简单)
nohup node app.js > app.log 2>&1 &

# 2. 使用tmux/screen (可交互)
tmux new -s my-session
# 在tmux中启动进程后，按 Ctrl+B, D 分离会话
tmux attach -t my-session # 重新连接
```

---

## 5. 文件操作与传输

### 压缩与解压
```bash
# 压缩文件夹
zip -r archive_name.zip folder_to_compress/

# 解压zip文件
unzip archive_name.zip
# 解压到指定目录
unzip archive_name.zip -d /target/path
```

### 跨服务器传输 (scp)
```bash
# 从本地复制到远程
scp -P 22 /local/file.txt user@remote_ip:/remote/path/

# 从远程复制到本地
scp user@remote_ip:/remote/file.txt /local/path/

# 递归复制整个目录
scp -r /local/folder/ user@remote_ip:/remote/path/
```

---

## 6. HTTPS 配置全攻略

### 使用 Certbot 获取免费 SSL 证书
```bash
# 1. 安装Certbot (以Ubuntu/Nginx为例)
sudo apt update
sudo apt install certbot python3-certbot-nginx

# 2. 获取证书并自动配置Nginx (推荐)
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com

# 3. 测试自动续签
sudo certbot renew --dry-run
```
**流程**：安装 -> 运行命令（会自动修改Nginx配置）-> 测试续签。

### Nginx HTTPS 服务器块配置示例
```nginx
server {
    listen 443 ssl http2;
    server_name yourdomain.com;

    # 证书路径（Certbot会自动设置）
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    # 网站根目录（Hexo项目）
    root /www/wwwroot/yourdomain;
    index index.html;

    # 静态资源缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}

# HTTP 强制重定向到 HTTPS
server {
    listen 80;
    server_name yourdomain.com;
    return 301 https://$server_name$request_uri;
}
```

---

## 7. 核心概念解析

### Web 架构中的角色
| 组件 | 角色 | 职责 |
| :--- | :--- | :--- |
| **Nginx/Apache** | **Web服务器 / 网关** | 处理HTTP/S、SSL、静态文件、反向代理、负载均衡 |
| **Node.js** | **应用运行时** | 执行JavaScript代码，处理动态逻辑、API、数据库 |
| **Hexo** | **静态站点生成器** | **预生成**所有HTML/CSS/JS文件，之后由Web服务器提供 |

### 端口与协议
*   **80端口**：HTTP协议，明文传输。
*   **443端口**：HTTPS协议，加密传输。**启用HTTPS必须监听此端口**。
*   工作流程：用户 <-> (HTTPS/443) Nginx <-> (HTTP/内网端口) Node.js应用。

### 总结：从问题到解决方案的映射

| 你遇到的问题 | 核心命令/解决方案 |
| :--- | :--- |
| 网站访问不了 | 1. `systemctl status nginx` <br> 2. `nginx -t` <br> 3. `ss -tulnp` |
| 宝塔面板打不开 | 1. `sudo /etc/init.d/bt default` <br> 2. `sudo systemctl restart bt` |
| Node.js进程关闭SSH就断 | 1. `pm2 start ...` <br> 2. `pm2 startup && pm2 save` |
| 申请HTTPS证书 | `sudo certbot --nginx -d yourdomain.com` |
| 传输文件/备份 | `scp ...` / `zip -r ...` |
| 查看谁在运行 | `sudo ss -tulnp` |

这份指南几乎涵盖了你遇到的所有场景。遇到问题时，先定位问题类型，然后找到对应的章节使用命令进行排查即可。